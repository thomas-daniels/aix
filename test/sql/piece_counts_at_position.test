# name: test/sql/piece_counts_at_position.test
# description: test piece_counts_at_position function
# group: [sql]


require aixchess


query I
SELECT piece_counts_at_position('\x9F-\x84\x1C\x1A\x9D:\xBD\xB3\xB8'::BLOB, 6);
----
{'wK': 1, 'wQ': 1, 'wR': 2, 'wB': 2, 'wN': 2, 'wP': 8, 'bK': 1, 'bQ': 1, 'bR': 2, 'bB': 2, 'bN': 2, 'bP': 8}


query I
SELECT piece_counts_at_position('\x0C\x1C4$\x05\x1A9*\x06\x151)\x04\x07>-\x0A\x12=\x22\x9A5\xBC5\x15&5>\x03\x11-#\x91#>=#5\x00'::BLOB, 6);
----
{'wK': 1, 'wQ': 1, 'wR': 2, 'wB': 2, 'wN': 2, 'wP': 8, 'bK': 1, 'bQ': 1, 'bR': 2, 'bB': 2, 'bN': 2, 'bP': 8}


query I
SELECT piece_counts_at_position('<]\x93.\x0DT?\xE2\xEC\xDE\xEFaFR\x973\xDB\x03v'::BLOB, 6);
----
{'wK': 1, 'wQ': 1, 'wR': 2, 'wB': 2, 'wN': 2, 'wP': 8, 'bK': 1, 'bQ': 1, 'bR': 2, 'bB': 2, 'bN': 2, 'bP': 8}


query I
SELECT TRY(piece_counts_at_position('invalid'::BLOB, 6));
----
NULL


query I
SELECT piece_counts_at_position('\x9F-\x84\x1C\x1A\x9D:\xBD\xB3\xB8'::BLOB, -1);
----
{'wK': 1, 'wQ': 1, 'wR': 2, 'wB': 1, 'wN': 2, 'wP': 8, 'bK': 1, 'bQ': 1, 'bR': 2, 'bB': 2, 'bN': 1, 'bP': 7}


query I
SELECT piece_counts_at_position('\x0C\x1C4$\x05\x1A9*\x06\x151)\x04\x07>-\x0A\x12=\x22\x9A5\xBC5\x15&5>\x03\x11-#\x91#>=#5\x00'::BLOB, -1);
----
{'wK': 1, 'wQ': 1, 'wR': 2, 'wB': 1, 'wN': 2, 'wP': 8, 'bK': 1, 'bQ': 1, 'bR': 2, 'bB': 2, 'bN': 1, 'bP': 7}


query I
SELECT piece_counts_at_position('<]\x93.\x0DT?\xE2\xEC\xDE\xEFaFR\x973\xDB\x03v'::BLOB, -1);
----
{'wK': 1, 'wQ': 1, 'wR': 2, 'wB': 1, 'wN': 2, 'wP': 8, 'bK': 1, 'bQ': 1, 'bR': 2, 'bB': 2, 'bN': 1, 'bP': 7}


query I
SELECT TRY(piece_counts_at_position('invalid'::BLOB, -1));
----
NULL
