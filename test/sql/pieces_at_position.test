# name: test/sql/pieces_at_position.test
# description: test pieces_at_position function
# group: [sql]


require aixchess


query I
SELECT pieces_at_position('\x9F-\x84\x1C\x1A\x9D:\xBD\xB3\xB8'::BLOB, 6);
----
{'wK': e1, 'wQ': [d1], 'wR': [a1, h1], 'wB': [c1, c4], 'wN': [b1, f3], 'wP': [a2, b2, c2, d2, e4, f2, g2, h2], 'bK': e8, 'bQ': [d8], 'bR': [a8, h8], 'bB': [c8, f8], 'bN': [c6, g8], 'bP': [a7, b6, c7, d7, e5, f7, g7, h7]}


query I
SELECT pieces_at_position('\x0C\x1C4$\x05\x1A9*\x06\x151)\x04\x07>-\x0A\x12=\x22\x9A5\xBC5\x15&5>\x03\x11-#\x91#>=#5\x00'::BLOB, 6);
----
{'wK': e1, 'wQ': [d1], 'wR': [a1, h1], 'wB': [c1, c4], 'wN': [b1, f3], 'wP': [a2, b2, c2, d2, e4, f2, g2, h2], 'bK': e8, 'bQ': [d8], 'bR': [a8, h8], 'bB': [c8, f8], 'bN': [c6, g8], 'bP': [a7, b6, c7, d7, e5, f7, g7, h7]}


query I
SELECT pieces_at_position('<]\x93.\x0DT?\xE2\xEC\xDE\xEFaFR\x973\xDB\x03v'::BLOB, 6);
----
{'wK': e1, 'wQ': [d1], 'wR': [a1, h1], 'wB': [c1, c4], 'wN': [b1, f3], 'wP': [a2, b2, c2, d2, e4, f2, g2, h2], 'bK': e8, 'bQ': [d8], 'bR': [a8, h8], 'bB': [c8, f8], 'bN': [c6, g8], 'bP': [a7, b6, c7, d7, e5, f7, g7, h7]}


query I
SELECT TRY(pieces_at_position('invalid'::BLOB, 6));
----
NULL


query I
SELECT pieces_at_position('\x9F-\x84\x1C\x1A\x9D:\xBD\xB3\xB8'::BLOB, -1);
----
{'wK': g1, 'wQ': [f7], 'wR': [a1, f1], 'wB': [c1], 'wN': [b1, g5], 'wP': [a2, b2, c3, d2, e4, f2, g2, h2], 'bK': f8, 'bQ': [d8], 'bR': [a8, h8], 'bB': [c5, c8], 'bN': [c6], 'bP': [a7, b6, c7, d7, e5, g7, h7]}


query I
SELECT pieces_at_position('\x0C\x1C4$\x05\x1A9*\x06\x151)\x04\x07>-\x0A\x12=\x22\x9A5\xBC5\x15&5>\x03\x11-#\x91#>=#5\x00'::BLOB, -1);
----
{'wK': g1, 'wQ': [f7], 'wR': [a1, f1], 'wB': [c1], 'wN': [b1, g5], 'wP': [a2, b2, c3, d2, e4, f2, g2, h2], 'bK': f8, 'bQ': [d8], 'bR': [a8, h8], 'bB': [c5, c8], 'bN': [c6], 'bP': [a7, b6, c7, d7, e5, g7, h7]}


query I
SELECT pieces_at_position('<]\x93.\x0DT?\xE2\xEC\xDE\xEFaFR\x973\xDB\x03v'::BLOB, -1);
----
{'wK': g1, 'wQ': [f7], 'wR': [a1, f1], 'wB': [c1], 'wN': [b1, g5], 'wP': [a2, b2, c3, d2, e4, f2, g2, h2], 'bK': f8, 'bQ': [d8], 'bR': [a8, h8], 'bB': [c5, c8], 'bN': [c6], 'bP': [a7, b6, c7, d7, e5, g7, h7]}


query I
SELECT TRY(pieces_at_position('invalid'::BLOB, -1));
----
NULL
